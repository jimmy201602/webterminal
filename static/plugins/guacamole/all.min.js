var Guacamole=Guacamole||{};Guacamole.ArrayBufferReader=function(b){var a=this;b.onblob=function(f){var g=window.atob(f);var d=new ArrayBuffer(g.length);var e=new Uint8Array(d);for(var c=0;c<g.length;c++){e[c]=g.charCodeAt(c)}if(a.ondata){a.ondata(d)}};b.onend=function(){if(a.onend){a.onend()}};this.ondata=null;this.onend=null};var Guacamole=Guacamole||{};Guacamole.ArrayBufferWriter=function(c){var b=this;c.onack=function(d){if(b.onack){b.onack(d)}};function a(d){var f="";for(var e=0;e<d.byteLength;e++){f+=String.fromCharCode(d[e])}c.sendBlob(window.btoa(f))}this.blobLength=Guacamole.ArrayBufferWriter.DEFAULT_BLOB_LENGTH;this.sendData=function(e){var d=new Uint8Array(e);if(d.length<=b.blobLength){a(d)}else{for(var f=0;f<d.length;f+=b.blobLength){a(d.subarray(f,f+b.blobLength))}}};this.sendEnd=function(){c.sendEnd()};this.onack=null};Guacamole.ArrayBufferWriter.DEFAULT_BLOB_LENGTH=6048;var Guacamole=Guacamole||{};Guacamole.AudioContextFactory={singleton:null,getAudioContext:function getAudioContext(){var b=window.AudioContext||window.webkitAudioContext;if(b){try{if(!Guacamole.AudioContextFactory.singleton){Guacamole.AudioContextFactory.singleton=new b()}return Guacamole.AudioContextFactory.singleton}catch(a){}}return null}};var Guacamole=Guacamole||{};Guacamole.AudioPlayer=function AudioPlayer(){this.sync=function a(){}};Guacamole.AudioPlayer.isSupportedType=function isSupportedType(a){return Guacamole.RawAudioPlayer.isSupportedType(a)};Guacamole.AudioPlayer.getSupportedTypes=function getSupportedTypes(){return Guacamole.RawAudioPlayer.getSupportedTypes()};Guacamole.AudioPlayer.getInstance=function getInstance(b,a){if(Guacamole.RawAudioPlayer.isSupportedType(a)){return new Guacamole.RawAudioPlayer(b,a)}return null};Guacamole.RawAudioPlayer=function RawAudioPlayer(e,a){var n=Guacamole.RawAudioFormat.parse(a);var d=Guacamole.AudioContextFactory.getAudioContext();var m=d.currentTime;var b=new Guacamole.ArrayBufferReader(e);var o=0.02;var j=0.3;var k=(n.bytesPerSample===1)?window.Int8Array:window.Int16Array;var i=(n.bytesPerSample===1)?128:32768;var g=[];var f=function f(v){if(v.length<=1){return v[0]}var x=0;v.forEach(function s(y){x+=y.length});var w=0;var t=new k(x);v.forEach(function u(y){t.set(y,w);w+=y.length});return t};var q=function q(v){var z=Number.MAX_VALUE;var x=v.length;var y=Math.floor(v.length/n.channels);var A=Math.floor(n.rate*o);var s=Math.max(n.channels*A,n.channels*(y-A));for(var u=s;u<v.length;u+=n.channels){var t=0;for(var w=0;w<n.channels;w++){t+=Math.abs(v[u+w])}if(t<=z){x=u+n.channels;z=t}}if(x===v.length){return[v]}return[new k(v.buffer.slice(0,x*n.bytesPerSample)),new k(v.buffer.slice(x*n.bytesPerSample))]};var c=function c(s){g.push(new k(s))};var r=function r(){var s=f(g);if(!s){return null}g=q(s);s=g.shift();return s};var p=function p(y){var u=y.length/n.channels;var s=d.currentTime;if(m<s){m=s}var x=d.createBuffer(n.channels,u,n.rate);for(var w=0;w<n.channels;w++){var t=x.getChannelData(w);var z=w;for(var v=0;v<u;v++){t[v]=y[z]/i;z+=n.channels}}return x};b.ondata=function l(u){c(new k(u));var v=r();if(!v){return}var s=d.currentTime;if(m<s){m=s}var t=d.createBufferSource();t.connect(d.destination);if(!t.start){t.start=t.noteOn}t.buffer=p(v);t.start(m);m+=v.length/n.channels/n.rate};this.sync=function h(){var s=d.currentTime;m=Math.min(m,s+j)}};Guacamole.RawAudioPlayer.prototype=new Guacamole.AudioPlayer();Guacamole.RawAudioPlayer.isSupportedType=function isSupportedType(a){if(!Guacamole.AudioContextFactory.getAudioContext()){return false}return Guacamole.RawAudioFormat.parse(a)!==null};Guacamole.RawAudioPlayer.getSupportedTypes=function getSupportedTypes(){if(!Guacamole.AudioContextFactory.getAudioContext()){return[]}return["audio/L8","audio/L16"]};var Guacamole=Guacamole||{};Guacamole.AudioRecorder=function AudioRecorder(){this.onclose=null;this.onerror=null};Guacamole.AudioRecorder.isSupportedType=function isSupportedType(a){return Guacamole.RawAudioRecorder.isSupportedType(a)};Guacamole.AudioRecorder.getSupportedTypes=function getSupportedTypes(){return Guacamole.RawAudioRecorder.getSupportedTypes()};Guacamole.AudioRecorder.getInstance=function getInstance(b,a){if(Guacamole.RawAudioRecorder.isSupportedType(a)){return new Guacamole.RawAudioRecorder(b,a)}return null};Guacamole.RawAudioRecorder=function RawAudioRecorder(f,a){var e=this;var w=2048;var i=3;var t=Guacamole.RawAudioFormat.parse(a);var c=Guacamole.AudioContextFactory.getAudioContext();if(!navigator.mediaDevices){navigator.mediaDevices={}}if(!navigator.mediaDevices.getUserMedia){navigator.mediaDevices.getUserMedia=(navigator.getUserMedia||navigator.webkitGetUserMedia||navigator.mozGetUserMedia||navigator.msGetUserMedia).bind(navigator)}var s=new Guacamole.ArrayBufferWriter(f);var q=(t.bytesPerSample===1)?window.Int8Array:window.Int16Array;var l=(t.bytesPerSample===1)?128:32768;var v=0;var u=0;var r=null;var p=null;var d=null;var o=function o(y){if(y===0){return 1}var z=Math.PI*y;return Math.sin(z)/z};var j=function j(y,z){if(-z<y&&y<z){return o(y)*o(y/z)}return 0};var n=function m(z,B){var y=(z.length-1)*B;var D=Math.floor(y)-i+1;var x=Math.floor(y)+i;var C=0;for(var A=D;A<=x;A++){C+=(z[A]||0)*j(y-A,i)}return C};var g=function g(D){var x=D.length;v+=x;var E=Math.round(v*t.rate/D.sampleRate);var F=E-u;u+=F;var A=new q(F*t.channels);for(var B=0;B<t.channels;B++){var C=D.getChannelData(B);var y=B;for(var z=0;z<F;z++){A[y]=n(C,z/(F-1))*l;y+=t.channels}}return A};var h=function h(){navigator.mediaDevices.getUserMedia({audio:true},function y(A){d=c.createScriptProcessor(w,t.channels,t.channels);d.connect(c.destination);d.onaudioprocess=function z(B){s.sendData(g(B.inputBuffer).buffer)};p=c.createMediaStreamSource(A);p.connect(d);r=A},function x(){s.sendEnd();if(e.onerror){e.onerror()}})};var k=function k(){if(p){p.disconnect()}if(d){d.disconnect()}if(r){var x=r.getTracks();for(var y=0;y<x.length;y++){x[y].stop()}}d=null;p=null;r=null;s.sendEnd()};s.onack=function b(x){if(x.code===Guacamole.Status.Code.SUCCESS&&!r){h()}else{k();s.onack=null;if(x.code===Guacamole.Status.Code.RESOURCE_CLOSED){if(e.onclose){e.onclose()}}else{if(e.onerror){e.onerror()}}}}};Guacamole.RawAudioRecorder.prototype=new Guacamole.AudioRecorder();Guacamole.RawAudioRecorder.isSupportedType=function isSupportedType(a){if(!Guacamole.AudioContextFactory.getAudioContext()){return false}return Guacamole.RawAudioFormat.parse(a)!==null};Guacamole.RawAudioRecorder.getSupportedTypes=function getSupportedTypes(){if(!Guacamole.AudioContextFactory.getAudioContext()){return[]}return["audio/L8","audio/L16"]};var Guacamole=Guacamole||{};Guacamole.BlobReader=function(e,a){var d=this;var c=0;var b;if(window.BlobBuilder){b=new BlobBuilder()}else{if(window.WebKitBlobBuilder){b=new WebKitBlobBuilder()}else{if(window.MozBlobBuilder){b=new MozBlobBuilder()}else{b=new (function(){var f=[];this.append=function(g){f.push(new Blob([g],{type:a}))};this.getBlob=function(){return new Blob(f,{type:a})}})()}}}e.onblob=function(j){var k=window.atob(j);var g=new ArrayBuffer(k.length);var h=new Uint8Array(g);for(var f=0;f<k.length;f++){h[f]=k.charCodeAt(f)}b.append(g);c+=g.byteLength;if(d.onprogress){d.onprogress(g.byteLength)}e.sendAck("OK",0)};e.onend=function(){if(d.onend){d.onend()}};this.getLength=function(){return c};this.getBlob=function(){return b.getBlob()};this.onprogress=null;this.onend=null};var Guacamole=Guacamole||{};Guacamole.BlobWriter=function BlobWriter(d){var f=this;var a=new Guacamole.ArrayBufferWriter(d);a.onack=function(g){if(f.onack){f.onack(g)}};var c=function c(h,l,g){var i=(h.slice||h.webkitSlice||h.mozSlice).bind(h);var j=g-l;if(j!==g){var k=i(l,j);if(k.size===j){return k}}return i(l,g)};this.sendBlob=function b(i){var l=0;var g=new FileReader();var k=function k(){if(l>=i.size){if(f.oncomplete){f.oncomplete(i)}return}var m=c(i,l,l+a.blobLength);l+=a.blobLength;g.readAsArrayBuffer(m)};g.onload=function h(){a.sendData(g.result);a.onack=function m(n){if(f.onack){f.onack(n)}if(n.isError()){return}if(f.onprogress){f.onprogress(i,l-a.blobLength)}k()}};g.onerror=function j(){if(f.onerror){f.onerror(i,l,g.error)}};k()};this.sendEnd=function e(){a.sendEnd()};this.onack=null;this.onerror=null;this.onprogress=null;this.oncomplete=null};var Guacamole=Guacamole||{};Guacamole.Client=function(h){var q=this;var v=0;var c=1;var A=2;var x=3;var n=4;var K=5;var s=v;var F=0;var t=null;var j={0:"butt",1:"round",2:"square"};var L={0:"bevel",1:"miter",2:"round"};var u=new Guacamole.Display();var C={};var w={};var G={};var k=[];var r=[];var D=[];var H=new Guacamole.IntegerPool();var M=[];function I(O){if(O!=s){s=O;if(q.onstatechange){q.onstatechange(s)}}}function y(){return s==x||s==A}this.exportState=function o(S){var Q={currentState:s,currentTimestamp:F,layers:{}};var O={};for(var P in C){O[P]=C[P]}u.flush(function R(){for(var W in O){var U=parseInt(W);var V=O[W];var T=V.toCanvas();var X={width:V.width,height:V.height};if(V.width&&V.height){X.url=T.toDataURL("image/png")}if(U>0){X.x=V.x;X.y=V.y;X.z=V.z;X.alpha=V.alpha;X.matrix=V.matrix;X.parent=m(V.parent)}Q.layers[W]=X}S(Q)})};this.importState=function E(T,V){var R;var P;s=T.currentState;F=T.currentTimestamp;for(R in C){P=parseInt(R);if(P>0){u.dispose(C[R])}}C={};for(R in T.layers){P=parseInt(R);var U=T.layers[R];var Q=b(P);u.resize(Q,U.width,U.height);if(U.url){u.setChannelMask(Q,Guacamole.Layer.SRC);u.draw(Q,0,0,U.url)}if(P>0&&U.parent>=0){var S=b(U.parent);u.move(Q,S,U.x,U.y,U.z);u.shade(Q,U.alpha);var O=U.matrix;u.distort(Q,O[0],O[1],O[2],O[3],O[4],O[5])}}u.flush(V)};this.getDisplay=function(){return u};this.sendSize=function(P,O){if(!y()){return}h.sendMessage("size",P,O)};this.sendKeyEvent=function(O,P){if(!y()){return}h.sendMessage("key",P,O)};this.sendMouseState=function(P){if(!y()){return}u.moveCursor(Math.floor(P.x),Math.floor(P.y));var O=0;if(P.left){O|=1}if(P.middle){O|=2}if(P.right){O|=4}if(P.up){O|=8}if(P.down){O|=16}h.sendMessage("mouse",Math.floor(P.x),Math.floor(P.y),O)};this.createOutputStream=function l(){var O=H.next();var P=M[O]=new Guacamole.OutputStream(q,O);return P};this.createAudioStream=function(O){var P=q.createOutputStream();h.sendMessage("audio",P.index,O);return P};this.createFileStream=function(O,P){var Q=q.createOutputStream();h.sendMessage("file",Q.index,O,P);return Q};this.createPipeStream=function(O,P){var Q=q.createOutputStream();h.sendMessage("pipe",Q.index,O,P);return Q};this.createClipboardStream=function(O){var P=q.createOutputStream();h.sendMessage("clipboard",P.index,O);return P};this.createArgumentValueStream=function z(O,P){var Q=q.createOutputStream();h.sendMessage("argv",Q.index,O,P);return Q};this.createObjectOutputStream=function p(Q,O,P){var R=q.createOutputStream();h.sendMessage("put",Q,R.index,O,P);return R};this.requestObjectInputStream=function d(P,O){if(!y()){return}h.sendMessage("get",P,O)};this.sendAck=function(O,Q,P){if(!y()){return}h.sendMessage("ack",O,Q,P)};this.sendBlob=function(O,P){if(!y()){return}h.sendMessage("blob",O,P)};this.endStream=function(O){if(!y()){return}h.sendMessage("end",O);if(M[O]){H.free(O);delete M[O]}};this.onstatechange=null;this.onname=null;this.onerror=null;this.onaudio=null;this.onvideo=null;this.onargv=null;this.onclipboard=null;this.onfile=null;this.onfilesystem=null;this.onpipe=null;this.onsync=null;var b=function b(O){var P=C[O];if(!P){if(O===0){P=u.getDefaultLayer()}else{if(O>0){P=u.createLayer()}else{P=u.createBuffer()}}C[O]=P}return P};var m=function m(P){if(!P){return null}for(var O in C){if(P===C[O]){return parseInt(O)}}return null};function g(O){var P=k[O];if(P==null){P=k[O]=new Guacamole.Parser();P.oninstruction=h.oninstruction}return P}var a={"miter-limit":function(O,P){u.setMiterLimit(O,parseFloat(P))}};var f={ack:function(P){var S=parseInt(P[0]);var Q=P[1];var O=parseInt(P[2]);var R=M[S];if(R){if(R.onack){R.onack(new Guacamole.Status(O,Q))}if(O>=256&&M[S]===R){H.free(S);delete M[S]}}},arc:function(U){var T=b(parseInt(U[0]));var P=parseInt(U[1]);var V=parseInt(U[2]);var O=parseInt(U[3]);var S=parseFloat(U[4]);var Q=parseFloat(U[5]);var R=parseInt(U[6]);u.arc(T,P,V,O,S,Q,R!=0)},argv:function(Q){var S=parseInt(Q[0]);var O=Q[1];var P=Q[2];if(q.onargv){var R=r[S]=new Guacamole.InputStream(q,S);q.onargv(R,O,P)}else{q.sendAck(S,"Receiving argument values unsupported",256)}},audio:function(Q){var S=parseInt(Q[0]);var P=Q[1];var R=r[S]=new Guacamole.InputStream(q,S);var O=null;if(q.onaudio){O=q.onaudio(R,P)}if(!O){O=Guacamole.AudioPlayer.getInstance(R,P)}if(O){w[S]=O;q.sendAck(S,"OK",0)}else{q.sendAck(S,"BAD TYPE",783)}},blob:function(O){var R=parseInt(O[0]);var P=O[1];var Q=r[R];if(Q&&Q.onblob){Q.onblob(P)}},body:function i(R){var S=parseInt(R[0]);var Q=D[S];var U=parseInt(R[1]);var O=R[2];var P=R[3];if(Q&&Q.onbody){var T=r[U]=new Guacamole.InputStream(q,U);Q.onbody(T,O,P)}else{q.sendAck(U,"Receipt of body unsupported",256)}},cfill:function(T){var U=parseInt(T[0]);var Q=b(parseInt(T[1]));var S=parseInt(T[2]);var R=parseInt(T[3]);var O=parseInt(T[4]);var P=parseInt(T[5]);u.setChannelMask(Q,U);u.fillColor(Q,S,R,O,P)},clip:function(P){var O=b(parseInt(P[0]));u.clip(O)},clipboard:function(P){var R=parseInt(P[0]);var O=P[1];if(q.onclipboard){var Q=r[R]=new Guacamole.InputStream(q,R);q.onclipboard(Q,O)}else{q.sendAck(R,"Clipboard unsupported",256)}},close:function(P){var O=b(parseInt(P[0]));u.close(O)},copy:function(W){var O=b(parseInt(W[0]));var S=parseInt(W[1]);var R=parseInt(W[2]);var Q=parseInt(W[3]);var X=parseInt(W[4]);var V=parseInt(W[5]);var P=b(parseInt(W[6]));var U=parseInt(W[7]);var T=parseInt(W[8]);u.setChannelMask(P,V);u.copy(O,S,R,Q,X,P,U,T)},cstroke:function(W){var T=parseInt(W[0]);var R=b(parseInt(W[1]));var X=j[parseInt(W[2])];var P=L[parseInt(W[3])];var V=parseInt(W[4]);var O=parseInt(W[5]);var Q=parseInt(W[6]);var S=parseInt(W[7]);var U=parseInt(W[8]);u.setChannelMask(R,T);u.strokeColor(R,X,P,V,O,Q,S,U)},cursor:function(V){var U=parseInt(V[0]);var T=parseInt(V[1]);var R=b(parseInt(V[2]));var P=parseInt(V[3]);var O=parseInt(V[4]);var S=parseInt(V[5]);var Q=parseInt(V[6]);u.setCursor(U,T,R,P,O,S,Q)},curve:function(U){var T=b(parseInt(U[0]));var Q=parseInt(U[1]);var P=parseInt(U[2]);var S=parseInt(U[3]);var R=parseInt(U[4]);var O=parseInt(U[5]);var V=parseInt(U[6]);u.curveTo(T,Q,P,S,R,O,V)},disconnect:function e(O){q.disconnect()},dispose:function(Q){var O=parseInt(Q[0]);if(O>0){var P=b(O);u.dispose(P);delete C[O]}else{if(O<0){delete C[O]}}},distort:function(W){var O=parseInt(W[0]);var V=parseFloat(W[1]);var U=parseFloat(W[2]);var T=parseFloat(W[3]);var S=parseFloat(W[4]);var R=parseFloat(W[5]);var Q=parseFloat(W[6]);if(O>=0){var P=b(O);u.distort(P,V,U,T,S,R,Q)}},error:function(P){var Q=P[0];var O=parseInt(P[1]);if(q.onerror){q.onerror(new Guacamole.Status(O,Q))}q.disconnect()},end:function(O){var Q=parseInt(O[0]);var P=r[Q];if(P){if(P.onend){P.onend()}delete r[Q]}},file:function(Q){var S=parseInt(Q[0]);var O=Q[1];var P=Q[2];if(q.onfile){var R=r[S]=new Guacamole.InputStream(q,S);q.onfile(R,O,P)}else{q.sendAck(S,"File transfer unsupported",256)}},filesystem:function B(Q){var R=parseInt(Q[0]);var P=Q[1];if(q.onfilesystem){var O=D[R]=new Guacamole.Object(q,R);q.onfilesystem(O,P)}},identity:function(P){var O=b(parseInt(P[0]));u.setTransform(O,1,0,0,1,0,0)},img:function(X){var O=parseInt(X[0]);var S=parseInt(X[1]);var R=b(parseInt(X[2]));var U=X[3];var V=parseInt(X[4]);var T=parseInt(X[5]);var W=r[O]=new Guacamole.InputStream(q,O);var Q=new Guacamole.DataURIReader(W,U);Q.onend=function P(){u.setChannelMask(R,S);u.draw(R,V,T,Q.getURI())}},jpeg:function(Q){var T=parseInt(Q[0]);var P=b(parseInt(Q[1]));var O=parseInt(Q[2]);var S=parseInt(Q[3]);var R=Q[4];u.setChannelMask(P,T);u.draw(P,O,S,"data:image/jpeg;base64,"+R)},lfill:function(Q){var R=parseInt(Q[0]);var P=b(parseInt(Q[1]));var O=b(parseInt(Q[2]));u.setChannelMask(P,R);u.fillLayer(P,O)},line:function(Q){var P=b(parseInt(Q[0]));var O=parseInt(Q[1]);var R=parseInt(Q[2]);u.lineTo(P,O,R)},lstroke:function(Q){var R=parseInt(Q[0]);var P=b(parseInt(Q[1]));var O=b(parseInt(Q[2]));u.setChannelMask(P,R);u.strokeLayer(P,O)},mouse:function N(P){var O=parseInt(P[0]);var Q=parseInt(P[1]);u.showCursor(true);u.moveCursor(O,Q)},move:function(T){var P=parseInt(T[0]);var Q=parseInt(T[1]);var O=parseInt(T[2]);var V=parseInt(T[3]);var U=parseInt(T[4]);if(P>0&&Q>=0){var R=b(P);var S=b(Q);u.move(R,S,O,V,U)}},name:function(O){if(q.onname){q.onname(O[0])}},nest:function(O){var P=g(parseInt(O[0]));P.receive(O[1])},pipe:function(Q){var S=parseInt(Q[0]);var O=Q[1];var P=Q[2];if(q.onpipe){var R=r[S]=new Guacamole.InputStream(q,S);q.onpipe(R,O,P)}else{q.sendAck(S,"Named pipes unsupported",256)}},png:function(Q){var T=parseInt(Q[0]);var P=b(parseInt(Q[1]));var O=parseInt(Q[2]);var S=parseInt(Q[3]);var R=Q[4];u.setChannelMask(P,T);u.draw(P,O,S,"data:image/png;base64,"+R)},pop:function(P){var O=b(parseInt(P[0]));u.pop(O)},push:function(P){var O=b(parseInt(P[0]));u.push(O)},rect:function(S){var Q=b(parseInt(S[0]));var O=parseInt(S[1]);var T=parseInt(S[2]);var P=parseInt(S[3]);var R=parseInt(S[4]);u.rect(Q,O,T,P,R)},reset:function(P){var O=b(parseInt(P[0]));u.reset(O)},set:function(R){var P=b(parseInt(R[0]));var O=R[1];var S=R[2];var Q=a[O];if(Q){Q(P,S)}},shade:function(R){var O=parseInt(R[0]);var P=parseInt(R[1]);if(O>=0){var Q=b(O);u.shade(Q,P)}},size:function(S){var P=parseInt(S[0]);var Q=b(P);var R=parseInt(S[1]);var O=parseInt(S[2]);u.resize(Q,R,O)},start:function(Q){var P=b(parseInt(Q[0]));var O=parseInt(Q[1]);var R=parseInt(Q[2]);u.moveTo(P,O,R)},sync:function(P){var Q=parseInt(P[0]);u.flush(function O(){for(var S in w){var R=w[S];if(R){R.sync()}}if(Q!==F){h.sendMessage("sync",Q);F=Q}});if(s===A){I(x)}if(q.onsync){q.onsync(Q)}},transfer:function(W){var O=b(parseInt(W[0]));var T=parseInt(W[1]);var S=parseInt(W[2]);var R=parseInt(W[3]);var X=parseInt(W[4]);var Q=parseInt(W[5]);var P=b(parseInt(W[6]));var V=parseInt(W[7]);var U=parseInt(W[8]);if(Q===3){u.put(O,T,S,R,X,P,V,U)}else{if(Q!==5){u.transfer(O,T,S,R,X,P,V,U,Guacamole.Client.DefaultTransferFunction[Q])}}},transform:function(R){var Q=b(parseInt(R[0]));var P=parseFloat(R[1]);var O=parseFloat(R[2]);var V=parseFloat(R[3]);var U=parseFloat(R[4]);var T=parseFloat(R[5]);var S=parseFloat(R[6]);u.transform(Q,P,O,V,U,T,S)},undefine:function J(P){var Q=parseInt(P[0]);var O=D[Q];if(O&&O.onundefine){O.onundefine()}},video:function(R){var T=parseInt(R[0]);var P=b(parseInt(R[1]));var O=R[2];var S=r[T]=new Guacamole.InputStream(q,T);var Q=null;if(q.onvideo){Q=q.onvideo(S,P,O)}if(!Q){Q=Guacamole.VideoPlayer.getInstance(S,P,O)}if(Q){G[T]=Q;q.sendAck(T,"OK",0)}else{q.sendAck(T,"BAD TYPE",783)}}};h.oninstruction=function(Q,P){var O=f[Q];if(O){O(P)}};this.disconnect=function(){if(s!=K&&s!=n){I(n);if(t){window.clearInterval(t)}h.sendMessage("disconnect");h.disconnect();I(K)}};this.connect=function(P){I(c);try{h.connect(P)}catch(O){I(v);throw O}t=window.setInterval(function(){h.sendMessage("nop")},5000);I(A)}};Guacamole.Client.DefaultTransferFunction={0:function(a,b){b.red=b.green=b.blue=0},15:function(a,b){b.red=b.green=b.blue=255},3:function(a,b){b.red=a.red;b.green=a.green;b.blue=a.blue;b.alpha=a.alpha},5:function(a,b){},12:function(a,b){b.red=255&~a.red;b.green=255&~a.green;b.blue=255&~a.blue;b.alpha=a.alpha},10:function(a,b){b.red=255&~b.red;b.green=255&~b.green;b.blue=255&~b.blue},1:function(a,b){b.red=(a.red&b.red);b.green=(a.green&b.green);b.blue=(a.blue&b.blue)},14:function(a,b){b.red=255&~(a.red&b.red);b.green=255&~(a.green&b.green);b.blue=255&~(a.blue&b.blue)},7:function(a,b){b.red=(a.red|b.red);b.green=(a.green|b.green);b.blue=(a.blue|b.blue)},8:function(a,b){b.red=255&~(a.red|b.red);b.green=255&~(a.green|b.green);b.blue=255&~(a.blue|b.blue)},6:function(a,b){b.red=(a.red^b.red);b.green=(a.green^b.green);b.blue=(a.blue^b.blue)},9:function(a,b){b.red=255&~(a.red^b.red);b.green=255&~(a.green^b.green);b.blue=255&~(a.blue^b.blue)},4:function(a,b){b.red=255&(~a.red&b.red);b.green=255&(~a.green&b.green);b.blue=255&(~a.blue&b.blue)},13:function(a,b){b.red=255&(~a.red|b.red);b.green=255&(~a.green|b.green);b.blue=255&(~a.blue|b.blue)},2:function(a,b){b.red=255&(a.red&~b.red);b.green=255&(a.green&~b.green);b.blue=255&(a.blue&~b.blue)},11:function(a,b){b.red=255&(a.red|~b.red);b.green=255&(a.green|~b.green);b.blue=255&(a.blue|~b.blue)}};var Guacamole=Guacamole||{};Guacamole.DataURIReader=function(g,b){var f=this;var e="data:"+b+";base64,";g.onblob=function a(h){e+=h};g.onend=function c(){if(f.onend){f.onend()}};this.getURI=function d(){return e};this.onend=null};var Guacamole=Guacamole||{};Guacamole.Display=function(){var b=this;var f=0;var c=0;var k=1;var m=document.createElement("div");m.style.position="relative";m.style.width=f+"px";m.style.height=c+"px";m.style.transformOrigin=m.style.webkitTransformOrigin=m.style.MozTransformOrigin=m.style.OTransformOrigin=m.style.msTransformOrigin="0 0";var e=new Guacamole.Display.VisibleLayer(f,c);var d=new Guacamole.Display.VisibleLayer(0,0);d.setChannelMask(Guacamole.Layer.SRC);m.appendChild(e.getElement());m.appendChild(d.getElement());var h=document.createElement("div");h.style.position="relative";h.style.width=(f*k)+"px";h.style.height=(c*k)+"px";h.appendChild(m);this.cursorHotspotX=0;this.cursorHotspotY=0;this.cursorX=0;this.cursorY=0;this.onresize=null;this.oncursor=null;var j=[];var i=[];function g(){var s=0;while(s<i.length){var t=i[s];if(!t.isReady()){break}t.flush();s++}i.splice(0,s)}function n(t,s){this.isReady=function(){for(var u=0;u<s.length;u++){if(s[u].blocked){return false}}return true};this.flush=function(){for(var u=0;u<s.length;u++){s[u].execute()}if(t){t()}}}function a(u,t){var s=this;this.blocked=t;this.unblock=function(){if(s.blocked){s.blocked=false;g()}};this.execute=function(){if(u){u()}}}function p(u,t){var s=new a(u,t);j.push(s);return s}this.getElement=function(){return h};this.getWidth=function(){return f};this.getHeight=function(){return c};this.getDefaultLayer=function(){return e};this.getCursorLayer=function(){return d};this.createLayer=function(){var s=new Guacamole.Display.VisibleLayer(f,c);s.move(e,0,0,0);return s};this.createBuffer=function(){var s=new Guacamole.Layer(0,0);s.autosize=1;return s};this.flush=function(s){i.push(new n(s,j));j=[];g()};this.setCursor=function(y,w,x,t,s,v,z){p(function u(){b.cursorHotspotX=y;b.cursorHotspotY=w;d.resize(v,z);d.copy(x,t,s,v,z,0,0);b.moveCursor(b.cursorX,b.cursorY);if(b.oncursor){b.oncursor(d.toCanvas(),y,w)}})};this.showCursor=function(u){var s=d.getElement();var t=s.parentNode;if(u===false){if(t){t.removeChild(s)}}else{if(t!==m){m.appendChild(s)}}};this.moveCursor=function(s,t){d.translate(s-b.cursorHotspotX,t-b.cursorHotspotY);b.cursorX=s;b.cursorY=t};this.resize=function(t,u,s){p(function v(){t.resize(u,s);if(t===e){f=u;c=s;m.style.width=f+"px";m.style.height=c+"px";h.style.width=(f*k)+"px";h.style.height=(c*k)+"px";if(b.onresize){b.onresize(u,s)}}})};this.drawImage=function(u,s,w,v){p(function t(){u.drawImage(s,w,v)})};this.drawBlob=function(z,t,B,v){var w=URL.createObjectURL(v);var u=p(function s(){if(A.width&&A.height){z.drawImage(t,B,A)}URL.revokeObjectURL(w)},true);var A=new Image();A.onload=u.unblock;A.onerror=u.unblock;A.src=w};this.draw=function(w,s,A,v){var u=p(function t(){if(z.width&&z.height){w.drawImage(s,A,z)}},true);var z=new Image();z.onload=u.unblock;z.onerror=u.unblock;z.src=v};this.play=function(u,s,w,t){var v=document.createElement("video");v.type=s;v.src=t;v.addEventListener("play",function(){function x(){u.drawImage(0,0,v);if(!v.ended){window.setTimeout(x,20)}}x()},false);p(v.play)};this.transfer=function(A,t,s,u,D,w,B,z,v){p(function C(){w.transfer(A,t,s,u,D,B,z,v)})};this.put=function(A,t,s,u,C,w,B,z){p(function v(){w.put(A,t,s,u,C,B,z)})};this.copy=function(A,t,s,u,C,v,B,z){p(function w(){v.copy(A,t,s,u,C,B,z)})};this.moveTo=function(u,s,v){p(function t(){u.moveTo(s,v)})};this.lineTo=function(u,s,v){p(function t(){u.lineTo(s,v)})};this.arc=function(A,t,B,s,z,u,w){p(function v(){A.arc(t,B,s,z,u,w)})};this.curveTo=function(z,u,t,w,v,s,B){p(function A(){z.curveTo(u,t,w,v,s,B)})};this.close=function(s){p(function t(){s.close()})};this.rect=function(u,s,A,t,v){p(function z(){u.rect(s,A,t,v)})};this.clip=function(s){p(function t(){s.clip()})};this.strokeColor=function(v,z,t,x,s,u,w,y){p(function A(){v.strokeColor(z,t,x,s,u,w,y)})};this.fillColor=function(u,w,v,s,t){p(function x(){u.fillColor(w,v,s,t)})};this.strokeLayer=function(w,v,x,u,t){p(function s(){w.strokeLayer(v,x,u,t)})};this.fillLayer=function(t,s){p(function u(){t.fillLayer(s)})};this.push=function(t){p(function s(){t.push()})};this.pop=function(t){p(function s(){t.pop()})};this.reset=function(s){p(function t(){s.reset()})};this.setTransform=function(u,t,s,z,x,w,v){p(function y(){u.setTransform(t,s,z,x,w,v)})};this.transform=function(v,u,s,z,y,x,w){p(function t(){v.transform(u,s,z,y,x,w)})};this.setChannelMask=function(t,s){p(function u(){t.setChannelMask(s)})};this.setMiterLimit=function(u,s){p(function t(){u.setMiterLimit(s)})};this.dispose=function q(s){p(function t(){s.dispose()})};this.distort=function o(u,t,s,z,y,x,w){p(function v(){u.distort(t,s,z,y,x,w)})};this.move=function l(t,u,s,A,w){p(function v(){t.move(u,s,A,w)})};this.shade=function r(t,u){p(function s(){t.shade(u)})};this.scale=function(s){m.style.transform=m.style.WebkitTransform=m.style.MozTransform=m.style.OTransform=m.style.msTransform="scale("+s+","+s+")";k=s;h.style.width=(f*k)+"px";h.style.height=(c*k)+"px"};this.getScale=function(){return k};this.flatten=function(){var t=document.createElement("canvas");t.width=e.width;t.height=e.height;var u=t.getContext("2d");function s(z){var y=[];for(var x in z.children){y.push(z.children[x])}y.sort(function w(D,C){var E=D.z-C.z;if(E!==0){return E}var B=D.getElement();var F=C.getElement();var A=F.compareDocumentPosition(B);if(A&Node.DOCUMENT_POSITION_PRECEDING){return -1}if(A&Node.DOCUMENT_POSITION_FOLLOWING){return 1}return 0});return y}function v(C,z,E){if(C.width>0&&C.height>0){var w=u.globalAlpha;u.globalAlpha*=C.alpha/255;u.drawImage(C.getCanvas(),z,E);var B=s(C);for(var A=0;A<B.length;A++){var D=B[A];v(D,z+D.x,E+D.y)}u.globalAlpha=w}}v(e,0,0);return t}};Guacamole.Display.VisibleLayer=function(f,a){Guacamole.Layer.apply(this,[f,a]);var e=this;this.__unique_id=Guacamole.Display.VisibleLayer.__next_id++;this.alpha=255;this.x=0;this.y=0;this.z=0;this.matrix=[1,0,0,1,0,0];this.parent=null;this.children={};var d=e.getCanvas();d.style.position="absolute";d.style.left="0px";d.style.top="0px";var h=document.createElement("div");h.appendChild(d);h.style.width=f+"px";h.style.height=a+"px";h.style.position="absolute";h.style.left="0px";h.style.top="0px";h.style.overflow="hidden";var c=this.resize;this.resize=function(j,i){h.style.width=j+"px";h.style.height=i+"px";c(j,i)};this.getElement=function(){return h};var g="translate(0px, 0px)";var b="matrix(1, 0, 0, 1, 0, 0)";this.translate=function(i,j){e.x=i;e.y=j;g="translate("+i+"px,"+j+"px)";h.style.transform=h.style.WebkitTransform=h.style.MozTransform=h.style.OTransform=h.style.msTransform=g+" "+b};this.move=function(j,i,m,l){if(e.parent!==j){if(e.parent){delete e.parent.children[e.__unique_id]}e.parent=j;j.children[e.__unique_id]=e;var k=j.getElement();k.appendChild(h)}e.translate(i,m);e.z=l;h.style.zIndex=l};this.shade=function(i){e.alpha=i;h.style.opacity=i/255};this.dispose=function(){if(e.parent){delete e.parent.children[e.__unique_id];e.parent=null}if(h.parentNode){h.parentNode.removeChild(h)}};this.distort=function(j,i,n,m,l,k){e.matrix=[j,i,n,m,l,k];b="matrix("+j+","+i+","+n+","+m+","+l+","+k+")";h.style.transform=h.style.WebkitTransform=h.style.MozTransform=h.style.OTransform=h.style.msTransform=g+" "+b}};Guacamole.Display.VisibleLayer.__next_id=0;var Guacamole=Guacamole||{};Guacamole.InputSink=function InputSink(){var g=this;var c=document.createElement("textarea");c.style.position="fixed";c.style.outline="none";c.style.border="none";c.style.margin="0";c.style.padding="0";c.style.height="0";c.style.width="0";c.style.left="0";c.style.bottom="0";c.style.resize="none";c.style.background="transparent";c.style.color="transparent";c.addEventListener("keypress",function h(j){c.value=""},false);c.addEventListener("compositionend",function e(j){if(j.data){c.value=""}},false);c.addEventListener("input",function b(j){if(j.data&&!j.isComposing){c.value=""}},false);c.addEventListener("focus",function f(){window.setTimeout(function j(){c.click();c.select()},0)},true);this.focus=function i(){window.setTimeout(function j(){c.focus()},0)};this.getElement=function a(){return c};document.addEventListener("keydown",function d(l){var k=document.activeElement;if(k&&k!==document.body){var j=k.getBoundingClientRect();if(j.left+j.width>0&&j.top+j.height>0){return}}g.focus()},true)};var Guacamole=Guacamole||{};Guacamole.InputStream=function(a,b){var c=this;this.index=b;this.onblob=null;this.onend=null;this.sendAck=function(e,d){a.sendAck(c.index,e,d)}};var Guacamole=Guacamole||{};Guacamole.IntegerPool=function(){var b=this;var a=[];this.next_int=0;this.next=function(){if(a.length>0){return a.shift()}return b.next_int++};this.free=function(c){a.push(c)}};var Guacamole=Guacamole||{};Guacamole.JSONReader=function guacamoleJSONReader(g){var a=this;var f=new Guacamole.StringReader(g);var c="";this.getLength=function b(){return c.length};this.getJSON=function d(){return JSON.parse(c)};f.ontext=function h(i){c+=i;if(a.onprogress){a.onprogress(i.length)}};f.onend=function e(){if(a.onend){a.onend()}};this.onprogress=null;this.onend=null};var Guacamole=Guacamole||{};Guacamole.Keyboard=function Keyboard(b){var m=this;var B=Guacamole.Keyboard._nextID++;var f="_GUAC_KEYBOARD_HANDLED_BY_"+B;this.onkeydown=null;this.onkeyup=null;var z={keyupUnreliable:false,altIsTypableOnly:false,capsLockKeyupUnreliable:false};if(navigator&&navigator.platform){if(navigator.platform.match(/ipad|iphone|ipod/i)){z.keyupUnreliable=true}else{if(navigator.platform.match(/^mac/i)){z.altIsTypableOnly=true;z.capsLockKeyupUnreliable=true}}}var D=function(){var J=this;this.timestamp=new Date().getTime();this.defaultPrevented=false;this.keysym=null;this.reliable=false;this.getAge=function(){return new Date().getTime()-J.timestamp}};var E=function(O,N,L,J){D.apply(this);this.keyCode=O;this.keyIdentifier=N;this.key=L;this.location=J;this.keysym=G(L,J)||l(O,J);this.keyupReliable=!z.keyupUnreliable;if(this.keysym&&!y(this.keysym)){this.reliable=true}if(!this.keysym&&d(O,N)){this.keysym=G(N,J,m.modifiers.shift)}if(m.modifiers.meta&&this.keysym!==65511&&this.keysym!==65512){this.keyupReliable=false}else{if(this.keysym===65509&&z.capsLockKeyupUnreliable){this.keyupReliable=false}}var K=!m.modifiers.ctrl&&!z.altIsTypableOnly;var M=!m.modifiers.alt;if((M&&m.modifiers.ctrl)||(K&&m.modifiers.alt)||m.modifiers.meta||m.modifiers.hyper){this.reliable=true}o[O]=this.keysym};E.prototype=new D();var a=function(J){D.apply(this);this.charCode=J;this.keysym=v(J);this.reliable=true};a.prototype=new D();var n=function(M,L,K,J){D.apply(this);this.keyCode=M;this.keyIdentifier=L;this.key=K;this.location=J;this.keysym=l(M,J)||G(K,J);if(!m.pressed[this.keysym]){this.keysym=o[M]||this.keysym}this.reliable=true};n.prototype=new D();var I=[];var C={8:[65288],9:[65289],12:[65291,65291,65291,65461],13:[65293],16:[65505,65505,65506],17:[65507,65507,65508],18:[65513,65513,65027],19:[65299],20:[65509],27:[65307],32:[32],33:[65365,65365,65365,65465],34:[65366,65366,65366,65459],35:[65367,65367,65367,65457],36:[65360,65360,65360,65463],37:[65361,65361,65361,65460],38:[65362,65362,65362,65464],39:[65363,65363,65363,65462],40:[65364,65364,65364,65458],45:[65379,65379,65379,65456],46:[65535,65535,65535,65454],91:[65515],92:[65383],93:null,96:[65456],97:[65457],98:[65458],99:[65459],100:[65460],101:[65461],102:[65462],103:[65463],104:[65464],105:[65465],106:[65450],107:[65451],109:[65453],110:[65454],111:[65455],112:[65470],113:[65471],114:[65472],115:[65473],116:[65474],117:[65475],118:[65476],119:[65477],120:[65478],121:[65479],122:[65480],123:[65481],144:[65407],145:[65300],225:[65027]};var i={Again:[65382],AllCandidates:[65341],Alphanumeric:[65328],Alt:[65513,65513,65027],Attn:[64782],AltGraph:[65027],ArrowDown:[65364],ArrowLeft:[65361],ArrowRight:[65363],ArrowUp:[65362],Backspace:[65288],CapsLock:[65509],Cancel:[65385],Clear:[65291],Convert:[65313],Copy:[64789],Crsel:[64796],CrSel:[64796],CodeInput:[65335],Compose:[65312],Control:[65507,65507,65508],ContextMenu:[65383],Delete:[65535],Down:[65364],End:[65367],Enter:[65293],EraseEof:[64774],Escape:[65307],Execute:[65378],Exsel:[64797],ExSel:[64797],F1:[65470],F2:[65471],F3:[65472],F4:[65473],F5:[65474],F6:[65475],F7:[65476],F8:[65477],F9:[65478],F10:[65479],F11:[65480],F12:[65481],F13:[65482],F14:[65483],F15:[65484],F16:[65485],F17:[65486],F18:[65487],F19:[65488],F20:[65489],F21:[65490],F22:[65491],F23:[65492],F24:[65493],Find:[65384],GroupFirst:[65036],GroupLast:[65038],GroupNext:[65032],GroupPrevious:[65034],FullWidth:null,HalfWidth:null,HangulMode:[65329],Hankaku:[65321],HanjaMode:[65332],Help:[65386],Hiragana:[65317],HiraganaKatakana:[65319],Home:[65360],Hyper:[65517,65517,65518],Insert:[65379],JapaneseHiragana:[65317],JapaneseKatakana:[65318],JapaneseRomaji:[65316],JunjaMode:[65336],KanaMode:[65325],KanjiMode:[65313],Katakana:[65318],Left:[65361],Meta:[65511,65511,65512],ModeChange:[65406],NumLock:[65407],PageDown:[65366],PageUp:[65365],Pause:[65299],Play:[64790],PreviousCandidate:[65342],PrintScreen:[65377],Redo:[65382],Right:[65363],RomanCharacters:null,Scroll:[65300],Select:[65376],Separator:[65452],Shift:[65505,65505,65506],SingleCandidate:[65340],Super:[65515,65515,65516],Tab:[65289],UIKeyInputDownArrow:[65364],UIKeyInputEscape:[65307],UIKeyInputLeftArrow:[65361],UIKeyInputRightArrow:[65363],UIKeyInputUpArrow:[65362],Up:[65362],Undo:[65381],Win:[65515],Zenkaku:[65320],ZenkakuHankaku:[65322]};var x={65027:true,65505:true,65506:true,65507:true,65508:true,65509:true,65511:true,65512:true,65513:true,65514:true,65515:true,65516:true};this.modifiers=new Guacamole.Keyboard.ModifierState();this.pressed={};var e={};var t={};var o={};var c=null;var s=null;var p=function p(K,J){if(!K){return null}return K[J]||K[0]};var y=function y(J){return(J>=0&&J<=255)||(J&4294901760)===16777216};function G(L,K,O){if(!L){return null}var N;var J=L.indexOf("U+");if(J>=0){var M=L.substring(J+2);N=String.fromCharCode(parseInt(M,16))}else{if(L.length===1&&K!==3){N=L}else{return p(i[L],K)}}if(O===true){N=N.toUpperCase()}else{if(O===false){N=N.toLowerCase()}}var P=N.charCodeAt(0);return v(P)}function r(J){return J<=31||(J>=127&&J<=159)}function v(J){if(r(J)){return 65280|J}if(J>=0&&J<=255){return J}if(J>=256&&J<=1114111){return 16777216|J}return null}function l(K,J){return p(C[K],J)}var d=function d(M,L){if(!L){return false}var J=L.indexOf("U+");if(J===-1){return true}var K=parseInt(L.substring(J+2),16);if(M!==K){return true}if((M>=65&&M<=90)||(M>=48&&M<=57)){return true}return false};this.press=function(K){if(K===null){return}if(!m.pressed[K]){m.pressed[K]=true;if(m.onkeydown){var J=m.onkeydown(K);t[K]=J;window.clearTimeout(c);window.clearInterval(s);if(!x[K]){c=window.setTimeout(function(){s=window.setInterval(function(){m.onkeyup(K);m.onkeydown(K)},50)},500)}return J}}return t[K]||false};this.release=function(J){if(m.pressed[J]){delete m.pressed[J];delete e[J];window.clearTimeout(c);window.clearInterval(s);if(J!==null&&m.onkeyup){m.onkeyup(J)}}};this.type=function h(M){for(var J=0;J<M.length;J++){var L=M.codePointAt?M.codePointAt(J):M.charCodeAt(J);var K=v(L);m.press(K);m.release(K)}};this.reset=function(){for(var J in m.pressed){m.release(parseInt(J))}I=[]};var H=function H(M,J,L,N){var K;if(L.indexOf(N.keysym)!==-1){return}if(M&&J===false){for(K=0;K<L.length;K++){m.release(L[K])}}else{if(!M&&J){for(K=0;K<L.length;K++){if(m.pressed[L[K]]){return}}var O=L[0];if(N.keysym){e[O]=true}m.press(O)}}};var k=function k(L,K){var J=Guacamole.Keyboard.ModifierState.fromKeyboardEvent(L);H(m.modifiers.alt,J.alt,[65513,65514,65027],K);H(m.modifiers.shift,J.shift,[65505,65506],K);H(m.modifiers.ctrl,J.ctrl,[65507,65508],K);H(m.modifiers.meta,J.meta,[65511,65512],K);H(m.modifiers.hyper,J.hyper,[65515,65516],K);m.modifiers=J};var g=function g(){for(var J in m.pressed){if(!e[J]){return false}}return true};function j(){var K=u();if(!K){return false}var J;do{J=K;K=u()}while(K!==null);if(g()){m.reset()}return J.defaultPrevented}var A=function A(J){if(!m.modifiers.ctrl||!m.modifiers.alt){return}if(J>=65&&J<=90){return}if(J>=97&&J<=122){return}if(J<=255||(J&4278190080)===16777216){m.release(65507);m.release(65508);m.release(65513);m.release(65514)}};var u=function u(){var M=I[0];if(!M){return null}if(M instanceof E){var L=null;var N=[];if(M.reliable){L=M.keysym;N=I.splice(0,1)}else{if(I[1] instanceof a){L=I[1].keysym;N=I.splice(0,2)}else{if(I[1]){L=M.keysym;N=I.splice(0,1)}}}if(N.length>0){if(L){A(L);var J=!m.press(L);o[M.keyCode]=L;if(!M.keyupReliable){m.release(L)}for(var K=0;K<N.length;K++){N[K].defaultPrevented=J}}return M}}else{if(M instanceof n&&!z.keyupUnreliable){var L=M.keysym;if(L){m.release(L);delete o[M.keyCode];M.defaultPrevented=true}else{m.reset();return M}return I.shift()}else{return I.shift()}}return null};var F=function F(J){if("location" in J){return J.location}if("keyLocation" in J){return J.keyLocation}return 0};var w=function w(J){if(J[f]){return false}J[f]=true;return true};this.listenTo=function q(J){J.addEventListener("keydown",function(O){if(!m.onkeydown){return}if(!w(O)){return}var N;if(window.event){N=window.event.keyCode}else{if(O.which){N=O.which}}var M=new E(N,O.keyIdentifier,O.key,F(O));k(O,M);if(N===229){return}I.push(M);if(j()){O.preventDefault()}},true);J.addEventListener("keypress",function(O){if(!m.onkeydown&&!m.onkeyup){return}if(!w(O)){return}var N;if(window.event){N=window.event.keyCode}else{if(O.which){N=O.which}}var M=new a(N);k(O,M);I.push(M);if(j()){O.preventDefault()}},true);J.addEventListener("keyup",function(O){if(!m.onkeyup){return}if(!w(O)){return}O.preventDefault();var N;if(window.event){N=window.event.keyCode}else{if(O.which){N=O.which}}var M=new n(N,O.keyIdentifier,O.key,F(O));k(O,M);I.push(M);j()},true);var L=function L(M){if(!m.onkeydown&&!m.onkeyup){return}if(!w(M)){return}if(M.data&&!M.isComposing){J.removeEventListener("compositionend",K,false);m.type(M.data)}};var K=function K(M){if(!m.onkeydown&&!m.onkeyup){return}if(!w(M)){return}if(M.data){J.removeEventListener("input",L,false);m.type(M.data)}};J.addEventListener("input",L,false);J.addEventListener("compositionend",K,false)};if(b){m.listenTo(b)}};Guacamole.Keyboard._nextID=0;Guacamole.Keyboard.ModifierState=function(){this.shift=false;this.ctrl=false;this.alt=false;this.meta=false;this.hyper=false};Guacamole.Keyboard.ModifierState.fromKeyboardEvent=function(b){var a=new Guacamole.Keyboard.ModifierState();a.shift=b.shiftKey;a.ctrl=b.ctrlKey;a.alt=b.altKey;a.meta=b.metaKey;if(b.getModifierState){a.hyper=b.getModifierState("OS")||b.getModifierState("Super")||b.getModifierState("Hyper")||b.getModifierState("Win")}return a};var Guacamole=Guacamole||{};Guacamole.Layer=function(a,n){var h=this;var l=64;var d=document.createElement("canvas");var b=d.getContext("2d");b.save();var g=true;var e=true;var m=0;var j={1:"destination-in",2:"destination-out",4:"source-in",6:"source-atop",8:"source-out",9:"destination-atop",10:"xor",11:"destination-over",12:"copy",14:"source-over",15:"lighter"};var c=function c(t,r){t=t||0;r=r||0;var p=Math.ceil(t/l)*l;var s=Math.ceil(r/l)*l;if(d.width!==p||d.height!==s){var u=null;if(!g&&d.width!==0&&d.height!==0){u=document.createElement("canvas");u.width=Math.min(h.width,t);u.height=Math.min(h.height,r);var q=u.getContext("2d");q.drawImage(d,0,0,u.width,u.height,0,0,u.width,u.height)}var o=b.globalCompositeOperation;d.width=p;d.height=s;if(u){b.drawImage(u,0,0,u.width,u.height,0,0,u.width,u.height)}b.globalCompositeOperation=o;m=0;b.save()}else{h.reset()}h.width=t;h.height=r};function f(o,v,p,q){var t=p+o;var s=q+v;var r;if(t>h.width){r=t}else{r=h.width}var u;if(s>h.height){u=s}else{u=h.height}h.resize(r,u)}this.autosize=false;this.width=a;this.height=n;this.getCanvas=function k(){return d};this.toCanvas=function i(){var o=document.createElement("canvas");o.width=h.width;o.height=h.height;var p=o.getContext("2d");p.drawImage(h.getCanvas(),0,0);return o};this.resize=function(p,o){if(p!==h.width||o!==h.height){c(p,o)}};this.drawImage=function(o,q,p){if(h.autosize){f(o,q,p.width,p.height)}b.drawImage(p,o,q);g=false};this.transfer=function(A,r,p,s,D,B,z,u){var t=A.getCanvas();if(r>=t.width||p>=t.height){return}if(r+s>t.width){s=t.width-r}if(p+D>t.height){D=t.height-p}if(s===0||D===0){return}if(h.autosize){f(B,z,s,D)}var o=A.getCanvas().getContext("2d").getImageData(r,p,s,D);var w=b.getImageData(B,z,s,D);for(var v=0;v<s*D*4;v+=4){var q=new Guacamole.Layer.Pixel(o.data[v],o.data[v+1],o.data[v+2],o.data[v+3]);var C=new Guacamole.Layer.Pixel(w.data[v],w.data[v+1],w.data[v+2],w.data[v+3]);u(q,C);w.data[v]=C.red;w.data[v+1]=C.green;w.data[v+2]=C.blue;w.data[v+3]=C.alpha}b.putImageData(w,B,z);g=false};this.put=function(u,q,p,r,w,v,t){var s=u.getCanvas();if(q>=s.width||p>=s.height){return}if(q+r>s.width){r=s.width-q}if(p+w>s.height){w=s.height-p}if(r===0||w===0){return}if(h.autosize){f(v,t,r,w)}var o=u.getCanvas().getContext("2d").getImageData(q,p,r,w);b.putImageData(o,v,t);g=false};this.copy=function(s,q,p,r,u,o,v){var t=s.getCanvas();if(q>=t.width||p>=t.height){return}if(q+r>t.width){r=t.width-q}if(p+u>t.height){u=t.height-p}if(r===0||u===0){return}if(h.autosize){f(o,v,r,u)}b.drawImage(t,q,p,r,u,o,v,r,u);g=false};this.moveTo=function(o,p){if(e){b.beginPath();e=false}if(h.autosize){f(o,p,0,0)}b.moveTo(o,p)};this.lineTo=function(o,p){if(e){b.beginPath();e=false}if(h.autosize){f(o,p,0,0)}b.lineTo(o,p)};this.arc=function(p,t,o,s,q,r){if(e){b.beginPath();e=false}if(h.autosize){f(p,t,0,0)}b.arc(p,t,o,s,q,r)};this.curveTo=function(q,p,s,r,o,t){if(e){b.beginPath();e=false}if(h.autosize){f(o,t,0,0)}b.bezierCurveTo(q,p,s,r,o,t)};this.close=function(){b.closePath();e=true};this.rect=function(o,r,p,q){if(e){b.beginPath();e=false}if(h.autosize){f(o,r,p,q)}b.rect(o,r,p,q)};this.clip=function(){b.clip();e=true};this.strokeColor=function(s,v,q,u,t,o,p){b.lineCap=s;b.lineJoin=v;b.lineWidth=q;b.strokeStyle="rgba("+u+","+t+","+o+","+p/255+")";b.stroke();g=false;e=true};this.fillColor=function(s,q,o,p){b.fillStyle="rgba("+s+","+q+","+o+","+p/255+")";b.fill();g=false;e=true};this.strokeLayer=function(q,r,p,o){b.lineCap=q;b.lineJoin=r;b.lineWidth=p;b.strokeStyle=b.createPattern(o.getCanvas(),"repeat");b.stroke();g=false;e=true};this.fillLayer=function(o){b.fillStyle=b.createPattern(o.getCanvas(),"repeat");b.fill();g=false;e=true};this.push=function(){b.save();m++};this.pop=function(){if(m>0){b.restore();m--}};this.reset=function(){while(m>0){b.restore();m--}b.restore();b.save();b.beginPath();e=false};this.setTransform=function(p,o,t,s,r,q){b.setTransform(p,o,t,s,r,q)};this.transform=function(p,o,t,s,r,q){b.transform(p,o,t,s,r,q)};this.setChannelMask=function(o){b.globalCompositeOperation=j[o]};this.setMiterLimit=function(o){b.miterLimit=o};c(a,n);d.style.zIndex=-1};Guacamole.Layer.ROUT=2;Guacamole.Layer.ATOP=6;Guacamole.Layer.XOR=10;Guacamole.Layer.ROVER=11;Guacamole.Layer.OVER=14;Guacamole.Layer.PLUS=15;Guacamole.Layer.RIN=1;Guacamole.Layer.IN=4;Guacamole.Layer.OUT=8;Guacamole.Layer.RATOP=9;Guacamole.Layer.SRC=12;Guacamole.Layer.Pixel=function(f,e,c,d){this.red=f;this.green=e;this.blue=c;this.alpha=d};var Guacamole=Guacamole||{};Guacamole.Mouse=function(f){var e=this;this.touchMouseThreshold=3;this.scrollThreshold=53;this.PIXELS_PER_LINE=18;this.PIXELS_PER_PAGE=this.PIXELS_PER_LINE*16;this.currentState=new Guacamole.Mouse.State(0,0,false,false,false,false,false);this.onmousedown=null;this.onmouseup=null;this.onmousemove=null;this.onmouseout=null;var g=0;var a=0;function d(i){i.stopPropagation();if(i.preventDefault){i.preventDefault()}i.returnValue=false}f.addEventListener("contextmenu",function(i){d(i)},false);f.addEventListener("mousemove",function(i){d(i);if(g){g--;return}e.currentState.fromClientPosition(f,i.clientX,i.clientY);if(e.onmousemove){e.onmousemove(e.currentState)}},false);f.addEventListener("mousedown",function(i){d(i);if(g){return}switch(i.button){case 0:e.currentState.left=true;break;case 1:e.currentState.middle=true;break;case 2:e.currentState.right=true;break}if(e.onmousedown){e.onmousedown(e.currentState)}},false);f.addEventListener("mouseup",function(i){d(i);if(g){return}switch(i.button){case 0:e.currentState.left=false;break;case 1:e.currentState.middle=false;break;case 2:e.currentState.right=false;break}if(e.onmouseup){e.onmouseup(e.currentState)}},false);f.addEventListener("mouseout",function(j){if(!j){j=window.event}var i=j.relatedTarget||j.toElement;while(i){if(i===f){return}i=i.parentNode}d(j);if(e.currentState.left||e.currentState.middle||e.currentState.right){e.currentState.left=false;e.currentState.middle=false;e.currentState.right=false;if(e.onmouseup){e.onmouseup(e.currentState)}}if(e.onmouseout){e.onmouseout()}},false);f.addEventListener("selectstart",function(i){d(i)},false);function c(){g=e.touchMouseThreshold}f.addEventListener("touchmove",c,false);f.addEventListener("touchstart",c,false);f.addEventListener("touchend",c,false);function h(i){var j=i.deltaY||-i.wheelDeltaY||-i.wheelDelta;if(j){if(i.deltaMode===1){j=i.deltaY*e.PIXELS_PER_LINE}else{if(i.deltaMode===2){j=i.deltaY*e.PIXELS_PER_PAGE}}}else{j=i.detail*e.PIXELS_PER_LINE}a+=j;if(a<=-e.scrollThreshold){do{if(e.onmousedown){e.currentState.up=true;e.onmousedown(e.currentState)}if(e.onmouseup){e.currentState.up=false;e.onmouseup(e.currentState)}a+=e.scrollThreshold}while(a<=-e.scrollThreshold);a=0}if(a>=e.scrollThreshold){do{if(e.onmousedown){e.currentState.down=true;e.onmousedown(e.currentState)}if(e.onmouseup){e.currentState.down=false;e.onmouseup(e.currentState)}a-=e.scrollThreshold}while(a>=e.scrollThreshold);a=0}d(i)}f.addEventListener("DOMMouseScroll",h,false);f.addEventListener("mousewheel",h,false);f.addEventListener("wheel",h,false);var b=(function(){var j=document.createElement("div");if(!("cursor" in j.style)){return false}try{j.style.cursor="url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABAQMAAAAl21bKAAAAA1BMVEX///+nxBvIAAAACklEQVQI12NgAAAAAgAB4iG8MwAAAABJRU5ErkJggg==) 0 0, auto"}catch(i){return false}return/\burl\([^()]*\)\s+0\s+0\b/.test(j.style.cursor||"")})();this.setCursor=function(j,i,l){if(b){var k=j.toDataURL("image/png");f.style.cursor="url("+k+") "+i+" "+l+", auto";return true}return false}};Guacamole.Mouse.State=function(b,h,f,c,d,a,g){var e=this;this.x=b;this.y=h;this.left=f;this.middle=c;this.right=d;this.up=a;this.down=g;this.fromClientPosition=function(j,n,m){e.x=n-j.offsetLeft;e.y=m-j.offsetTop;var l=j.offsetParent;while(l&&!(l===document.body)){e.x-=l.offsetLeft-l.scrollLeft;e.y-=l.offsetTop-l.scrollTop;l=l.offsetParent}if(l){var k=document.body.scrollLeft||document.documentElement.scrollLeft;var i=document.body.scrollTop||document.documentElement.scrollTop;e.x-=l.offsetLeft-k;e.y-=l.offsetTop-i}}};Guacamole.Mouse.Touchpad=function(d){var c=this;this.scrollThreshold=20*(window.devicePixelRatio||1);this.clickTimingThreshold=250;this.clickMoveThreshold=10*(window.devicePixelRatio||1);this.currentState=new Guacamole.Mouse.State(0,0,false,false,false,false,false);this.onmousedown=null;this.onmouseup=null;this.onmousemove=null;var a=0;var h=0;var g=0;var f=0;var e=0;var b={1:"left",2:"right",3:"middle"};var j=false;var i=null;d.addEventListener("touchend",function(m){m.preventDefault();if(j&&m.touches.length===0){var l=new Date().getTime();var k=b[a];if(c.currentState[k]){c.currentState[k]=false;if(c.onmouseup){c.onmouseup(c.currentState)}if(i){window.clearTimeout(i);i=null}}if(l-f<=c.clickTimingThreshold&&e<c.clickMoveThreshold){c.currentState[k]=true;if(c.onmousedown){c.onmousedown(c.currentState)}i=window.setTimeout(function(){c.currentState[k]=false;if(c.onmouseup){c.onmouseup(c.currentState)}j=false},c.clickTimingThreshold)}if(!i){j=false}}},false);d.addEventListener("touchstart",function(l){l.preventDefault();a=Math.min(l.touches.length,3);if(i){window.clearTimeout(i);i=null}if(!j){j=true;var k=l.touches[0];h=k.clientX;g=k.clientY;f=new Date().getTime();e=0}},false);d.addEventListener("touchmove",function(m){m.preventDefault();var q=m.touches[0];var p=q.clientX-h;var o=q.clientY-g;e+=Math.abs(p)+Math.abs(o);if(a===1){var l=e/(new Date().getTime()-f);var n=1+l;c.currentState.x+=p*n;c.currentState.y+=o*n;if(c.currentState.x<0){c.currentState.x=0}else{if(c.currentState.x>=d.offsetWidth){c.currentState.x=d.offsetWidth-1}}if(c.currentState.y<0){c.currentState.y=0}else{if(c.currentState.y>=d.offsetHeight){c.currentState.y=d.offsetHeight-1}}if(c.onmousemove){c.onmousemove(c.currentState)}h=q.clientX;g=q.clientY}else{if(a===2){if(Math.abs(o)>=c.scrollThreshold){var k;if(o>0){k="down"}else{k="up"}c.currentState[k]=true;if(c.onmousedown){c.onmousedown(c.currentState)}c.currentState[k]=false;if(c.onmouseup){c.onmouseup(c.currentState)}h=q.clientX;g=q.clientY}}}},false)};Guacamole.Mouse.Touchscreen=function(e){var d=this;var k=false;var j=null;var i=null;var l=null;var h=null;this.scrollThreshold=20*(window.devicePixelRatio||1);this.clickTimingThreshold=250;this.clickMoveThreshold=16*(window.devicePixelRatio||1);this.longPressThreshold=500;this.currentState=new Guacamole.Mouse.State(0,0,false,false,false,false,false);this.onmousedown=null;this.onmouseup=null;this.onmousemove=null;function m(o){if(!d.currentState[o]){d.currentState[o]=true;if(d.onmousedown){d.onmousedown(d.currentState)}}}function g(o){if(d.currentState[o]){d.currentState[o]=false;if(d.onmouseup){d.onmouseup(d.currentState)}}}function c(o){m(o);g(o)}function b(o,p){d.currentState.fromClientPosition(e,o,p);if(d.onmousemove){d.onmousemove(d.currentState)}}function a(o){var r=o.touches[0]||o.changedTouches[0];var q=r.clientX-j;var p=r.clientY-i;return Math.sqrt(q*q+p*p)>=d.clickMoveThreshold}function f(o){var p=o.touches[0];k=true;j=p.clientX;i=p.clientY}function n(){window.clearTimeout(l);window.clearTimeout(h);k=false}e.addEventListener("touchend",function(o){if(!k){return}if(o.touches.length!==0||o.changedTouches.length!==1){n();return}window.clearTimeout(h);g("left");if(!a(o)){o.preventDefault();if(!d.currentState.left){var p=o.changedTouches[0];b(p.clientX,p.clientY);m("left");l=window.setTimeout(function(){g("left");n()},d.clickTimingThreshold)}}},false);e.addEventListener("touchstart",function(o){if(o.touches.length!==1){n();return}o.preventDefault();f(o);window.clearTimeout(l);h=window.setTimeout(function(){var p=o.touches[0];b(p.clientX,p.clientY);c("right");n()},d.longPressThreshold)},false);e.addEventListener("touchmove",function(o){if(!k){return}if(a(o)){window.clearTimeout(h)}if(o.touches.length!==1){n();return}if(d.currentState.left){o.preventDefault();var p=o.touches[0];b(p.clientX,p.clientY)}},false)};var Guacamole=Guacamole||{};var Guacamole=Guacamole||{};Guacamole.Object=function guacamoleObject(e,f){var g=this;var h={};var a=function a(j){var k=h[j];if(!k){return null}var l=k.shift();if(k.length===0){delete h[j]}return l};var d=function d(j,l){var k=h[j];if(!k){k=[];h[j]=k}k.push(l)};this.index=f;this.onbody=function i(l,j,k){var m=a(k);if(m){m(l,j)}};this.onundefine=null;this.requestInputStream=function c(k,j){if(j){d(k,j)}e.requestObjectInputStream(g.index,k)};this.createOutputStream=function b(j,k){return e.createObjectOutputStream(g.index,j,k)}};Guacamole.Object.ROOT_STREAM="/";Guacamole.Object.STREAM_INDEX_MIMETYPE="application/vnd.glyptodon.guacamole.stream-index+json";var Guacamole=Guacamole||{};Guacamole.OnScreenKeyboard=function(q){var e=this;var h={};var b={};var d=[];var i=function i(u,v){if(u.classList){u.classList.add(v)}else{u.className+=" "+v}};var j=function j(u,w){if(u.classList){u.classList.remove(w)}else{u.className=u.className.replace(/([^ ]+)[ ]*/g,function v(y,x){if(x===w){return""}return y})}};var t=0;var f=function f(){t=e.touchMouseThreshold};var r=function r(v,w,u,x){this.width=w;this.height=u;this.scale=function(y){v.style.width=(w*y)+"px";v.style.height=(u*y)+"px";if(x){v.style.lineHeight=(u*y)+"px";v.style.fontSize=y+"px"}}};var l=function l(w){for(var v=0;v<w.length;v++){var u=w[v];if(!(u in h)){return false}}return true};var g=function g(w){var x=e.keys[w];if(!x){return null}for(var u=x.length-1;u>=0;u--){var v=x[u];if(l(v.requires)){return v}}return null};var m=function m(x,y){if(!b[x]){i(y,"guac-keyboard-pressed");var w=g(x);if(w.modifier){var v="guac-keyboard-modifier-"+n(w.modifier);var u=h[w.modifier];if(!u){i(c,v);h[w.modifier]=w.keysym;if(e.onkeydown){e.onkeydown(w.keysym)}}else{j(c,v);delete h[w.modifier];if(e.onkeyup){e.onkeyup(u)}}}else{if(e.onkeydown){e.onkeydown(w.keysym)}}b[x]=true}};var o=function o(v,w){if(b[v]){j(w,"guac-keyboard-pressed");var u=g(v);if(!u.modifier&&e.onkeyup){e.onkeyup(u.keysym)}b[v]=false}};var c=document.createElement("div");c.className="guac-keyboard";c.onselectstart=c.onmousemove=c.onmouseup=c.onmousedown=function k(u){if(t){t--}u.stopPropagation();return false};this.touchMouseThreshold=3;this.onkeydown=null;this.onkeyup=null;this.layout=new Guacamole.OnScreenKeyboard.Layout(q);this.getElement=function(){return c};this.resize=function(w){var x=Math.floor(w*10/e.layout.width)/10;for(var v=0;v<d.length;v++){var u=d[v];u.scale(x)}};var s=function s(v,u){if(u instanceof Array){var x=[];for(var w=0;w<u.length;w++){x.push(new Guacamole.OnScreenKeyboard.Key(u[w],v))}return x}if(typeof u==="number"){return[new Guacamole.OnScreenKeyboard.Key({name:v,keysym:u})]}if(typeof u==="string"){return[new Guacamole.OnScreenKeyboard.Key({name:v,title:u})]}return[new Guacamole.OnScreenKeyboard.Key(u,v)]};var a=function a(w){var v={};for(var u in q.keys){v[u]=s(u,w[u])}return v};this.keys=a(q.keys);var n=function n(u){var v=u.replace(/([a-z])([A-Z])/g,"$1-$2").replace(/[^A-Za-z0-9]+/g,"-").toLowerCase();return v};var p=function p(A,x,v){var B;var u=document.createElement("div");if(v){i(u,"guac-keyboard-"+n(v))}if(x instanceof Array){i(u,"guac-keyboard-group");for(B=0;B<x.length;B++){p(u,x[B])}}else{if(x instanceof Object){i(u,"guac-keyboard-group");var F=Object.keys(x).sort();for(B=0;B<F.length;B++){var v=F[B];p(u,x[v],v)}}else{if(typeof x==="number"){i(u,"guac-keyboard-gap");d.push(new r(u,x,x))}else{if(typeof x==="string"){var H=x;if(H.length===1){H="0x"+H.charCodeAt(0).toString(16)}i(u,"guac-keyboard-key-container");var J=document.createElement("div");J.className="guac-keyboard-key guac-keyboard-key-"+n(H);var I=e.keys[x];if(I){for(B=0;B<I.length;B++){var G=I[B];var E=document.createElement("div");E.className="guac-keyboard-cap";E.textContent=G.title;for(var y=0;y<G.requires.length;y++){var K=G.requires[y];i(E,"guac-keyboard-requires-"+n(K));i(J,"guac-keyboard-uses-"+n(K))}J.appendChild(E)}}u.appendChild(J);d.push(new r(u,e.layout.keyWidths[x]||1,1,true));var D=function D(L){L.preventDefault();t=e.touchMouseThreshold;m(x,J)};var w=function w(L){L.preventDefault();t=e.touchMouseThreshold;o(x,J)};var z=function z(L){L.preventDefault();if(t===0){m(x,J)}};var C=function C(L){L.preventDefault();if(t===0){o(x,J)}};J.addEventListener("touchstart",D,true);J.addEventListener("touchend",w,true);J.addEventListener("mousedown",z,true);J.addEventListener("mouseup",C,true);J.addEventListener("mouseout",C,true)}}}}A.appendChild(u)};p(c,q.layout)};Guacamole.OnScreenKeyboard.Layout=function(a){this.language=a.language;this.type=a.type;this.keys=a.keys;this.layout=a.layout;this.width=a.width;this.keyWidths=a.keyWidths||{}};Guacamole.OnScreenKeyboard.Key=function(c,a){this.name=a||c.name;this.title=c.title||this.name;this.keysym=c.keysym||(function b(e){if(!e||e.length!==1){return null}var d=e.charCodeAt(0);if(d>=0&&d<=255){return d}if(d>=256&&d<=1114111){return 16777216|d}return null})(this.title);this.modifier=c.modifier;this.requires=c.requires||[]};var Guacamole=Guacamole||{};Guacamole.OutputStream=function(a,b){var c=this;this.index=b;this.onack=null;this.sendBlob=function(d){a.sendBlob(c.index,d)};this.sendEnd=function(){a.endStream(c.index)}};var Guacamole=Guacamole||{};Guacamole.Parser=function(){var e=this;var b="";var d=[];var c=-1;var a=0;this.receive=function(k){if(a>4096&&c>=a){b=b.substring(a);c-=a;a=0}b+=k;while(c<b.length){if(c>=a){var h=b.substring(a,c);var g=b.substring(c,c+1);d.push(h);if(g==";"){var j=d.shift();if(e.oninstruction!=null){e.oninstruction(j,d)}d.length=0}else{if(g!=","){throw new Error("Illegal terminator.")}}a=c+1}var f=b.indexOf(".",a);if(f!=-1){var i=parseInt(b.substring(c+1,f));if(isNaN(i)){throw new Error("Non-numeric character in element length.")}a=f+1;c=a+i}else{a=b.length;break}}};this.oninstruction=null};var Guacamole=Guacamole||{};Guacamole.RawAudioFormat=function RawAudioFormat(a){this.bytesPerSample=a.bytesPerSample;this.channels=a.channels;this.rate=a.rate};Guacamole.RawAudioFormat.parse=function parseFormat(g){var b;var f=null;var e=1;if(g.substring(0,9)==="audio/L8;"){g=g.substring(9);b=1}else{if(g.substring(0,10)==="audio/L16;"){g=g.substring(10);b=2}else{return null}}var k=g.split(",");for(var d=0;d<k.length;d++){var j=k[d];var c=j.indexOf("=");if(c===-1){return null}var a=j.substring(0,c);var h=j.substring(c+1);switch(a){case"channels":e=parseInt(h);break;case"rate":f=parseInt(h);break;default:return null}}if(f===null){return null}return new Guacamole.RawAudioFormat({bytesPerSample:b,channels:e,rate:f})};var Guacamole=Guacamole||{};Guacamole.SessionRecording=function SessionRecording(v){var b=this;var m=16384;var x=5000;var i=5;var q=[];var a=[];var r=0;var j=0;var s=new Guacamole.SessionRecording._PlaybackTunnel();var f=new Guacamole.Client(s);var l=-1;var g=null;var d=null;var y=null;f.connect();f.getDisplay().showCursor(false);v.oninstruction=function B(I,G){var F=new Guacamole.SessionRecording._Frame.Instruction(I,G.slice());a.push(F);r+=F.getSize();if(I==="sync"){var H=parseInt(G[0]);var J=new Guacamole.SessionRecording._Frame(H,a);q.push(J);if(q.length===1||(r>=m&&H-j>=x)){J.keyframe=true;j=H;r=0}a=[];if(b.onprogress){b.onprogress(b.getDuration())}}};var u=function u(F){if(q.length===0){return 0}return F-q[0].timestamp};var o=function o(G,H,J){if(G===H){return G}var F=Math.floor((G+H)/2);var I=u(q[F].timestamp);if(J<I&&F>G){return o(G,F-1,J)}if(J>I&&F<H){return o(F+1,H,J)}return F};var A=function A(G){var I=q[G];for(var H=0;H<I.instructions.length;H++){var F=I.instructions[H];s.receiveInstruction(F.opcode,F.args)}if(I.keyframe&&!I.clientState){f.exportState(function J(K){I.clientState=K})}};var n=function n(H,I,G){w();y=window.setTimeout(function F(){var M;for(M=H;M>=0;M--){var L=q[M];if(M===l){break}if(L.clientState){f.importState(L.clientState);break}}M++;var J=new Date().getTime();for(;M<=H;M++){var K=new Date().getTime();if(K-J>=i){break}A(M)}l=M-1;if(b.onseek){b.onseek(b.getPosition())}if(l!==H){n(H,I,Math.max(G-(new Date().getTime()-J),0))}else{I()}},G||0)};var w=function w(){window.clearTimeout(y)};var t=function t(){if(l+1<q.length){var G=q[l+1];var I=G.timestamp-g+d;var F=Math.max(I-new Date().getTime(),0);n(l+1,function H(){t()},F)}else{b.pause()}};this.onprogress=null;this.onplay=null;this.onpause=null;this.onseek=null;this.connect=function c(F){v.connect(F)};this.disconnect=function C(){v.disconnect()};this.getDisplay=function p(){return f.getDisplay()};this.isPlaying=function h(){return !!g};this.getPosition=function D(){if(l===-1){return 0}return u(q[l].timestamp)};this.getDuration=function E(){if(q.length===0){return 0}return u(q[q.length-1].timestamp)};this.play=function z(){if(!b.isPlaying()&&l+1<q.length){if(b.onplay){b.onplay()}var F=q[l+1];g=F.timestamp;d=new Date().getTime();t()}};this.seek=function e(F,I){if(q.length===0){return}var H=b.isPlaying();b.pause();n(o(0,q.length-1,F),function G(){if(H){b.play()}if(I){I()}})};this.pause=function k(){w();if(b.isPlaying()){if(b.onpause){b.onpause()}g=null;d=null}}};Guacamole.SessionRecording._Frame=function _Frame(b,a){this.keyframe=false;this.timestamp=b;this.instructions=a;this.clientState=null};Guacamole.SessionRecording._Frame.Instruction=function Instruction(d,b){var a=this;this.opcode=d;this.args=b;this.getSize=function c(){var f=a.opcode.length;for(var e=0;e<a.args.length;e++){f+=a.args[e].length}return f}};Guacamole.SessionRecording._PlaybackTunnel=function _PlaybackTunnel(){var e=this;this.connect=function b(f){};this.sendMessage=function c(f){};this.disconnect=function a(){};this.receiveInstruction=function d(g,f){if(e.oninstruction){e.oninstruction(g,f)}}};var Guacamole=Guacamole||{};Guacamole.Status=function(b,a){var c=this;this.code=b;this.message=a;this.isError=function(){return c.code<0||c.code>255}};Guacamole.Status.Code={SUCCESS:0,UNSUPPORTED:256,SERVER_ERROR:512,SERVER_BUSY:513,UPSTREAM_TIMEOUT:514,UPSTREAM_ERROR:515,RESOURCE_NOT_FOUND:516,RESOURCE_CONFLICT:517,RESOURCE_CLOSED:518,UPSTREAM_NOT_FOUND:519,UPSTREAM_UNAVAILABLE:520,SESSION_CONFLICT:521,SESSION_TIMEOUT:522,SESSION_CLOSED:523,CLIENT_BAD_REQUEST:768,CLIENT_UNAUTHORIZED:769,CLIENT_FORBIDDEN:771,CLIENT_TIMEOUT:776,CLIENT_OVERRUN:781,CLIENT_BAD_TYPE:783,CLIENT_TOO_MANY:797};Guacamole.Status.Code.fromHTTPCode=function fromHTTPCode(a){switch(a){case 400:return Guacamole.Status.Code.CLIENT_BAD_REQUEST;case 403:return Guacamole.Status.Code.CLIENT_FORBIDDEN;case 404:return Guacamole.Status.Code.RESOURCE_NOT_FOUND;case 429:return Guacamole.Status.Code.CLIENT_TOO_MANY;case 503:return Guacamole.Status.Code.SERVER_BUSY}return Guacamole.Status.Code.SERVER_ERROR};Guacamole.Status.Code.fromWebSocketCode=function fromWebSocketCode(a){switch(a){case 1000:return Guacamole.Status.Code.SUCCESS;case 1006:case 1015:return Guacamole.Status.Code.UPSTREAM_NOT_FOUND;case 1001:case 1012:case 1013:case 1014:return Guacamole.Status.Code.UPSTREAM_UNAVAILABLE}return Guacamole.Status.Code.SERVER_ERROR};var Guacamole=Guacamole||{};Guacamole.StringReader=function(e){var d=this;var b=new Guacamole.ArrayBufferReader(e);var f=0;var c=0;function a(h){var l="";var g=new Uint8Array(h);for(var j=0;j<g.length;j++){var k=g[j];if(f===0){if((k|127)===127){l+=String.fromCharCode(k)}else{if((k|31)===223){c=k&31;f=1}else{if((k|15)===239){c=k&15;f=2}else{if((k|7)===247){c=k&7;f=3}else{l+="\uFFFD"}}}}}else{if((k|63)===191){c=(c<<6)|(k&63);f--;if(f===0){l+=String.fromCharCode(c)}}else{f=0;l+="\uFFFD"}}}return l}b.ondata=function(g){var h=a(g);if(d.ontext){d.ontext(h)}};b.onend=function(){if(d.onend){d.onend()}};this.ontext=null;this.onend=null};var Guacamole=Guacamole||{};Guacamole.StringWriter=function(h){var e=this;var c=new Guacamole.ArrayBufferWriter(h);var a=new Uint8Array(8192);var g=0;c.onack=function(i){if(e.onack){e.onack(i)}};function f(i){if(g+i>=a.length){var j=new Uint8Array((g+i)*2);j.set(a);a=j}g+=i}function d(m){var k;var j;if(m<=127){k=0;j=1}else{if(m<=2047){k=192;j=2}else{if(m<=65535){k=224;j=3}else{if(m<=2097151){k=240;j=4}else{d(65533);return}}}}f(j);var n=g-1;for(var l=1;l<j;l++){a[n--]=128|(m&63);m>>=6}a[n]=k|m}function b(m){for(var j=0;j<m.length;j++){var l=m.charCodeAt(j);d(l)}if(g>0){var k=a.subarray(0,g);g=0;return k}}this.sendText=function(i){if(i.length){c.sendData(b(i))}};this.sendEnd=function(){c.sendEnd()};this.onack=null};var Guacamole=Guacamole||{};Guacamole.Tunnel=function(){this.connect=function(b){};this.disconnect=function(){};this.sendMessage=function(b){};this.setState=function(b){if(b!==this.state){this.state=b;if(this.onstatechange){this.onstatechange(b)}}};this.isConnected=function a(){return this.state===Guacamole.Tunnel.State.OPEN||this.state===Guacamole.Tunnel.State.UNSTABLE};this.state=Guacamole.Tunnel.State.CONNECTING;this.receiveTimeout=15000;this.unstableThreshold=1500;this.uuid=null;this.onerror=null;this.onstatechange=null;this.oninstruction=null};Guacamole.Tunnel.INTERNAL_DATA_OPCODE="";Guacamole.Tunnel.State={CONNECTING:0,OPEN:1,CLOSED:2,UNSTABLE:3};Guacamole.HTTPTunnel=function(i,p,y){var v=this;var l=i+"?connect";var z=i+"?read:";var o=i+"?write:";var k=1;var q=0;var w=k;var t=false;var h="";var c=!!p;var e=null;var n=null;var j=null;var d=500;var f=y||{};function m(B,C){for(var A in C){B.setRequestHeader(A,C[A])}}function b(){window.clearTimeout(e);window.clearTimeout(n);if(v.state===Guacamole.Tunnel.State.UNSTABLE){v.setState(Guacamole.Tunnel.State.OPEN)}e=window.setTimeout(function(){a(new Guacamole.Status(Guacamole.Status.Code.UPSTREAM_TIMEOUT,"Server timeout."))},v.receiveTimeout);n=window.setTimeout(function(){v.setState(Guacamole.Tunnel.State.UNSTABLE)},v.unstableThreshold)}function a(A){window.clearTimeout(e);window.clearTimeout(n);window.clearInterval(j);if(v.state===Guacamole.Tunnel.State.CLOSED){return}if(A.code!==Guacamole.Status.Code.SUCCESS&&v.onerror){if(v.state===Guacamole.Tunnel.State.CONNECTING||A.code!==Guacamole.Status.Code.RESOURCE_NOT_FOUND){v.onerror(A)}}t=false;v.setState(Guacamole.Tunnel.State.CLOSED)}this.sendMessage=function(){if(!v.isConnected()){return}if(arguments.length===0){return}function B(E){var D=new String(E);return D.length+"."+D}var C=B(arguments[0]);for(var A=1;A<arguments.length;A++){C+=","+B(arguments[A])}C+=";";h+=C;if(!t){s()}};function s(){if(!v.isConnected()){return}if(h.length>0){t=true;var A=new XMLHttpRequest();A.open("POST",o+v.uuid);A.withCredentials=c;m(A,f);A.setRequestHeader("Content-type","application/octet-stream");A.onreadystatechange=function(){if(A.readyState===4){b();if(A.status!==200){r(A)}else{s()}}};A.send(h);h=""}else{t=false}}function r(C){var B=parseInt(C.getResponseHeader("Guacamole-Status-Code"));if(B){var A=C.getResponseHeader("Guacamole-Error-Message");a(new Guacamole.Status(B,A))}else{if(C.status){a(new Guacamole.Status(Guacamole.Status.Code.fromHTTPCode(C.status),C.statusText))}else{a(new Guacamole.Status(Guacamole.Status.Code.UPSTREAM_NOT_FOUND))}}}function x(D){var A=null;var F=null;var C=0;var B=-1;var G=0;var E=new Array();function H(){if(!v.isConnected()){if(A!==null){clearInterval(A)}return}if(D.readyState<2){return}var I;try{I=D.status}catch(P){I=200}if(!F&&I===200){F=u()}if(D.readyState===3||D.readyState===4){b();if(w===k){if(D.readyState===3&&!A){A=setInterval(H,30)}else{if(D.readyState===4&&A){clearInterval(A)}}}if(D.status===0){v.disconnect();return}else{if(D.status!==200){r(D);return}}var O;try{O=D.responseText}catch(P){return}while(B<O.length){if(B>=G){var K=O.substring(G,B);var J=O.substring(B,B+1);E.push(K);if(J===";"){var N=E.shift();if(v.oninstruction){v.oninstruction(N,E)}E.length=0}G=B+1}var L=O.indexOf(".",G);if(L!==-1){var M=parseInt(O.substring(B+1,L));if(M===0){if(A){clearInterval(A)}D.onreadystatechange=null;D.abort();if(F){x(F)}break}G=L+1;B=G+M}else{G=O.length;break}}}}if(w===k){D.onreadystatechange=function(){if(D.readyState===3){C++;if(C>=2){w=q;D.onreadystatechange=H}}H()}}else{D.onreadystatechange=H}H()}var g=0;function u(){var A=new XMLHttpRequest();A.open("GET",z+v.uuid+":"+(g++));A.withCredentials=c;m(A,f);A.send(null);return A}this.connect=function(A){b();v.setState(Guacamole.Tunnel.State.CONNECTING);var B=new XMLHttpRequest();B.onreadystatechange=function(){if(B.readyState!==4){return}if(B.status!==200){r(B);return}b();v.uuid=B.responseText;v.setState(Guacamole.Tunnel.State.OPEN);j=setInterval(function C(){v.sendMessage("nop")},d);x(u())};B.open("POST",l,true);B.withCredentials=c;m(B,f);B.setRequestHeader("Content-type","application/x-www-form-urlencoded; charset=UTF-8");B.send(A)};this.disconnect=function(){a(new Guacamole.Status(Guacamole.Status.Code.SUCCESS,"Manually closed."))}};Guacamole.HTTPTunnel.prototype=new Guacamole.Tunnel();Guacamole.WebSocketTunnel=function(d){var g=this;var i=null;var a=null;var f=null;var c=null;var b={"http:":"ws:","https:":"wss:"};var h=500;if(d.substring(0,3)!=="ws:"&&d.substring(0,4)!=="wss:"){var k=b[window.location.protocol];if(d.substring(0,1)==="/"){d=k+"//"+window.location.host+d}else{var e=window.location.pathname.lastIndexOf("/");var m=window.location.pathname.substring(0,e+1);d=k+"//"+window.location.host+m+d}}function l(){window.clearTimeout(a);window.clearTimeout(f);if(g.state===Guacamole.Tunnel.State.UNSTABLE){g.setState(Guacamole.Tunnel.State.OPEN)}a=window.setTimeout(function(){j(new Guacamole.Status(Guacamole.Status.Code.UPSTREAM_TIMEOUT,"Server timeout."))},g.receiveTimeout);f=window.setTimeout(function(){g.setState(Guacamole.Tunnel.State.UNSTABLE)},g.unstableThreshold)}function j(n){window.clearTimeout(a);window.clearTimeout(f);window.clearInterval(c);if(g.state===Guacamole.Tunnel.State.CLOSED){return}if(n.code!==Guacamole.Status.Code.SUCCESS&&g.onerror){g.onerror(n)}g.setState(Guacamole.Tunnel.State.CLOSED);i.close()}this.sendMessage=function(q){if(!g.isConnected()){return}if(arguments.length===0){return}function o(s){var r=new String(s);return r.length+"."+r}var p=o(arguments[0]);for(var n=1;n<arguments.length;n++){p+=","+o(arguments[n])}p+=";";i.send(p)};this.connect=function(n){l();g.setState(Guacamole.Tunnel.State.CONNECTING);i=new WebSocket(d+"?"+n,"guacamole");i.onopen=function(p){l();c=setInterval(function o(){g.sendMessage(Guacamole.Tunnel.INTERNAL_DATA_OPCODE,"ping",new Date().getTime())},h)};i.onclose=function(o){if(o.reason){j(new Guacamole.Status(parseInt(o.reason),o.reason))}else{if(o.code){j(new Guacamole.Status(Guacamole.Status.Code.fromWebSocketCode(o.code)))}else{j(new Guacamole.Status(Guacamole.Status.Code.UPSTREAM_NOT_FOUND))}}};i.onmessage=function(q){l();var x=q.data;var v=0;var u;var p=[];do{var w=x.indexOf(".",v);if(w!==-1){var r=parseInt(x.substring(u+1,w));v=w+1;u=v+r}else{j(new Guacamole.Status(Guacamole.Status.Code.SERVER_ERROR,"Incomplete instruction."))}var t=x.substring(v,u);var o=x.substring(u,u+1);p.push(t);if(o===";"){var s=p.shift();if(g.state===Guacamole.Tunnel.State.CONNECTING){if(s===Guacamole.Tunnel.INTERNAL_DATA_OPCODE){g.uuid=p[0]}g.setState(Guacamole.Tunnel.State.OPEN)}if(s!==Guacamole.Tunnel.INTERNAL_DATA_OPCODE&&g.oninstruction){g.oninstruction(s,p)}p.length=0}v=u+1}while(v<x.length)}};this.disconnect=function(){j(new Guacamole.Status(Guacamole.Status.Code.SUCCESS,"Manually closed."))}};Guacamole.WebSocketTunnel.prototype=new Guacamole.Tunnel();Guacamole.ChainedTunnel=function(e){var c=this;var a;var g=[];var f=null;for(var d=0;d<arguments.length;d++){g.push(arguments[d])}function b(j){c.disconnect=j.disconnect;c.sendMessage=j.sendMessage;var i=function i(k){if(k&&k.code===Guacamole.Status.Code.UPSTREAM_TIMEOUT){g=[];return null}var l=g.shift();if(l){j.onerror=null;j.oninstruction=null;j.onstatechange=null;b(l)}return l};function h(){j.onstatechange=c.onstatechange;j.oninstruction=c.oninstruction;j.onerror=c.onerror;c.uuid=j.uuid;f=j}j.onstatechange=function(k){switch(k){case Guacamole.Tunnel.State.OPEN:h();if(c.onstatechange){c.onstatechange(k)}break;case Guacamole.Tunnel.State.CLOSED:if(!i()&&c.onstatechange){c.onstatechange(k)}break}};j.oninstruction=function(l,k){h();if(c.oninstruction){c.oninstruction(l,k)}};j.onerror=function(k){if(!i(k)&&c.onerror){c.onerror(k)}};j.connect(a)}this.connect=function(i){a=i;var h=f?f:g.shift();if(h){b(h)}else{if(c.onerror){c.onerror(Guacamole.Status.Code.SERVER_ERROR,"No tunnels to try.")}}}};Guacamole.ChainedTunnel.prototype=new Guacamole.Tunnel();Guacamole.StaticHTTPTunnel=function StaticHTTPTunnel(a,c,h){var e=this;var g=null;var b=h||{};function i(l,m){for(var k in m){l.setRequestHeader(k,m[k])}}this.sendMessage=function d(k){};this.connect=function j(l){e.disconnect();e.setState(Guacamole.Tunnel.State.CONNECTING);g=new XMLHttpRequest();g.open("GET",a);g.withCredentials=!!c;i(g,b);g.responseType="text";g.send(null);var n=0;var p=new Guacamole.Parser();p.oninstruction=function o(r,q){if(e.oninstruction){e.oninstruction(r,q)}};g.onreadystatechange=function m(){if(g.readyState===3||g.readyState===4){e.setState(Guacamole.Tunnel.State.OPEN);var q=g.responseText;var r=q.length;if(n<r){p.receive(q.substring(n));n=r}}if(g.readyState===4){e.disconnect()}};g.onerror=function k(){if(e.onerror){e.onerror(new Guacamole.Status(Guacamole.Status.Code.fromHTTPCode(g.status),g.statusText))}e.disconnect()}};this.disconnect=function f(){if(g){g.abort();g=null}e.setState(Guacamole.Tunnel.State.CLOSED)}};Guacamole.StaticHTTPTunnel.prototype=new Guacamole.Tunnel();var Guacamole=Guacamole||{};Guacamole.API_VERSION="1.1.0";var Guacamole=Guacamole||{};Guacamole.VideoPlayer=function VideoPlayer(){this.sync=function a(){}};Guacamole.VideoPlayer.isSupportedType=function isSupportedType(a){return false};Guacamole.VideoPlayer.getSupportedTypes=function getSupportedTypes(){return[]};Guacamole.VideoPlayer.getInstance=function getInstance(c,b,a){return null};